# Landslide Risk Mapping System

## 프로젝트 개요

산사태 위험 지도를 준 실시간으로 업데이트하고 생성하는 시스템 구현을 위한 저장소

## 목표

준 실시간으로 산사태 위험 지도를 업데이트하고 생성하는 것을 목표로 한다

## 핵심 아이디어

Sentinel-1 위성의 6/12일 재방문 주기를 기준으로 하이브리드 조기경보 프레임워크를 구현:

- **촬영일마다**: 지반의 상태(State)를 갱신
- **촬영일 사이**: 실시간 기상(Event)으로 조건부 확률 P(Landslide|State,Weather) 형태로 동적 조정

## 시스템 구성요소

### 1. 전처리 및 특징화
- JS-InSAR를 활용하여 식생 및 산악지역에서 측정점 밀도 최대화
- 촬영일 기준으로 라그(1-21일), API, 토양수분을 정렬
- 강우-토양수분-변형의 10-22일 지연관계 학습

### 2. 상태 추정 엔진
- MUSEnet을 통해 InSAR 저빈도 시계열과 일별 수문 변수 결합
- 일 단위 상태 벡터 산출 (속도, 가속도, coherence 포함)

### 3. 사건 반영 로직
- 촬영 간격 동안 실시간/예보 강우 및 토양수분 데이터 활용
- Baseline Risk(상태)를 Dynamic Factor(사건)로 보정
- 조건부 경보 확률과 리드타임(1-5일) 산출

### 4. 출력
- 한국 몬순 조건에서 동적 산사태 위험지도 (6/12일 갱신 + 중간일 실시간 조정)
- 확률기반 다단계 경보 (주의/경계/심각/긴급)

## 조건부 확률 모델

### 1. 기본 위험도 모델링
- Sentinel-1 위성 12일 주기에 맞춰 지반 침하 및 취약 상태 평가
- 과거 1-21일 누적 강우 및 토양 수분 정보를 입력으로 활용
- P(산사태|지반상태) 확률 모델링

### 2. 동적 위험도 조절 모델링
- 위성 관측 공백기간 중 돌발 기상 변화 대응
- 실시간 기상 데이터 활용 (강우강도, 지속시간, 임계값 초과 여부)
- 기본 위험도 모델과 결합하여 최종 산사태 위험 지도 생성

### 3. 모델 검증
- 실제 산사태 발생 이력과 비교
- AUC, POD 등 성능 지표 활용

## 배경 및 문제 인식

### 현재 시스템의 한계
- 산림청 산사태 정보 시스템은 1년 주기로 2월에만 갱신
- 경사도 위주의 위험도 측정으로 환경 변화(벌목 등) 반영 불가
- 경남 산청 사례: 위험 등급이 낮은 곳에서 대형 산사태 발생

### 해결 방안
실시간 위성 데이터와 기상 정보를 결합한 동적 위험도 평가 시스템 구축

## 데이터 수집 및 처리

### LDAPS 기상 데이터

#### 개요
- **LDAPS (Limited area Data Assimilation and Prediction System)**: 기상청 국지예보모델
- **공간 해상도**: 1.5km 격자
- **시간 해상도**: 1시간 간격
- **예보 범위**: 48시간 선행시간

#### 데이터 수집
```bash
# conda 환경 설정
conda env create -f environment_ldaps.yml
conda activate ldaps

# LDAPS 강수량 데이터 다운로드
python data/LDAPS/ldaps_load_grib.py
```

#### 처리 과정
1. **GRIB2 다운로드**: KMA Open API를 통한 원본 기상 데이터 수집
2. **지역 마스킹**: 대상 지역 (경남·경북·대구·울산·부산) 추출
3. **NetCDF 변환**: 분석 가능한 격자 데이터로 변환
4. **시계열 구성**: 24시간 연속 데이터로 재구성

#### 출력 파일
- **GRIB 원본**: `data/LDAPS/GRIB/l015_YYYYMMDDHHMM_lspr_h000.gb2`
- **NetCDF 처리본**: `data/LDAPS/NetCDF/LDAPS_Rain_YYYYMMDD.nc`

#### 환경변수 설정
```bash
# KMA API 키 설정 (필수)
set KMA_SERVICE_KEY=your_api_key_here
```

### 위성 데이터 (예정)
- **Sentinel-1 SAR**: InSAR 변위 측정
- **처리 주기**: 6/12일 간격
- **공간 해상도**: 20m

### 지형 데이터 (예정)
- **DEM**: 수치표고모델
- **경사도**: 사면 안정성 분석
- **토지이용**: 식생 및 개발 현황