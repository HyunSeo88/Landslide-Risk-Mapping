# 산사태 위험지도 (Landslide Risk Mapping System)

## 프로젝트 개요

**Sentinel-1 InSAR 기반 지반 취약 상태 및 n일 윈도우 크기의 기상, 토양 정보를 활용하여 산사태 위험도를 주기적으로 업데이트하는 산사태 위험지도 구축**

## 연구 동기

### 기존 시스템의 한계
- **산림청 산사태 위험지도**: 9개 인자(임상, 경급, 사면경사, 사면방위, 사면길이, 사면곡률, 모암, 토심, 지형습윤지수 등)를 로지스틱 회귀분석을 통해 산출
- **갱신 방식**: 인자 업데이트 시에만 갱신하여 지표변화 등이 충분히 반영되지 못함
- **정적 분석**: 지형 데이터가 업데이트될때마다 갱신되어 즉각적인 환경 변화(벌목 등) 반영 불가
- **실제 사례**: 경남 산청 등 위험 등급이 낮은 곳에서 대형 산사태 발생

### 개선 방향
- **동적이고 지속적인 갱신**: 산사태 위험지도의 정확한 예측을 위해 새로운 변수와 분석 방법론 필요
- **추가 변수 활용**: 과거 산불 이력, InSAR 변위정보 등 추가 활용으로 정확성 제고
- **신속한 반영**: Sentinel-1의 짧은 재방문주기(6~12일)로 지형 변화 신속 반영 가능
- **연관성 분석**: 산불과 산사태의 밀접한 연관 가능성을 고려한 연동 분석으로 정확도 향상 기대

## 방법론

### 데이터 페어링
- **시간 범위**: 산사태 발생 시점 기준 2~4개월의 기간을 하나의 pair로 설정하여 데이터 수집

### 입력 데이터
#### 정적 데이터
- 토지피복도, 임상도, 지질도
- DEM에서 추출한 6개 수문인자 (TWI, 곡률, 경사, 방위 등)
- 산불 이력

#### 동적 데이터
- 5일간 누적강우량
- 당일 최고1시간 강우량
- InSAR 기반 변위량

### 데이터 처리
- **정규화**: 모든 인자를 DEM 해상도(30m)로 맞춰 모델 입력
- **통합**: Sentinel-1 위성의 6/12일 재방문 주기를 기준으로 하이브리드 조기경보 프레임워크 구현

### 산출물
- **위험등급**: 픽셀(격자) 단위 1~5등급 산사태 위험정도
- **동적 갱신**: 촬영일마다 지반의 상태(State) 갱신, 촬영일 사이 실시간 기상(Event)으로 조건부 확률 P(Landslide|State,Weather) 형태로 동적 조정

## 시스템 구성요소

### 1. 전처리 및 특징화
- JS-InSAR를 활용하여 식생 및 산악지역에서 측정점 밀도 최대화
- 촬영일 기준으로 라그(1-21일), API, 토양수분을 정렬
- 강우-토양수분-변형의 10-22일 지연관계 학습

### 2. 상태 추정 엔진
- MUSEnet을 통해 InSAR 저빈도 시계열과 일별 수문 변수 결합
- 일 단위 상태 벡터 산출 (속도, 가속도, coherence 포함)

### 3. 사건 반영 로직
- 촬영 간격 동안 실시간/예보 강우 및 토양수분 데이터 활용
- Baseline Risk(상태)를 Dynamic Factor(사건)로 보정
- 조건부 경보 확률과 리드타임(1-5일) 산출

### 4. 출력
- 한국 몬순 조건에서 동적 산사태 위험지도 (6/12일 갱신 + 중간일 실시간 조정)
- 확률기반 다단계 경보 (주의/경계/심각/긴급)

## 조건부 확률 모델

### 1. 기본 위험도 모델링
- Sentinel-1 위성 12일 주기에 맞춰 지반 침하 및 취약 상태 평가
- 과거 1-21일 누적 강우 및 토양 수분 정보를 입력으로 활용
- P(산사태|지반상태) 확률 모델링

### 2. 동적 위험도 조절 모델링
- 위성 관측 공백기간 중 돌발 기상 변화 대응
- 실시간 기상 데이터 활용 (강우강도, 지속시간, 임계값 초과 여부)
- 기본 위험도 모델과 결합하여 최종 산사태 위험 지도 생성

### 3. 모델 검증
- 실제 산사태 발생 이력과 비교
- AUC, POD 등 성능 지표 활용

## 연구 난관 및 과제

### 1. 이력 자료 변환
- **문제점**: 산사태 및 산불 이력 자료가 csv(좌표)로 제공
- **과제**: 공간정보데이터로 변환 작업 필요

### 2. 광학영상 취득 곤란   
- **문제점**: 각 이벤트 전‧후 광학영상 확보 어려움
- **과제**: 대체 데이터 소스 및 분석 방법 모색

### 3. Labeling 정확도
- **문제점**: SAR의 coherence, intensity 차이 기반 산사태 발생 지역 레이블링의 정확도 문제
- **과제**: 레이블링 구축방안 개선 및 검증 방법 마련

### 4. 시계열 데이터 통합
- **문제점**: 서로 다른 주기를 가진 데이터(기상, SAR 등)의 통합 어려움
- **과제**: 다양한 주기의 데이터를 모델에 통합·학습시키는 방법론 개발

### 5. 산사태 - 산불 인과분석
- **문제점**: 산불과 산사태의 영향 관계를 시간선으로 분석 필요함
- **과제**: 해당 데이터가 공간정보데이터로 제공되지 않기 때문에 당장 인과분석을 하기가 어려워, 모델의 입력에 넣는 타당성을 확보하기 어려움

## 데이터 수집 및 처리

### LDAPS 기상 데이터

#### 개요
- **LDAPS (Limited area Data Assimilation and Prediction System)**: 기상청 국지예보모델
- **공간 해상도**: 1.5km 격자
- **시간 해상도**: 1시간 간격
- **예보 범위**: 48시간 선행시간

#### 데이터 수집
```bash
# conda 환경 설정
conda env create -f environment_ldaps.yml
conda activate ldaps

# LDAPS 강수량 데이터 다운로드
python data/LDAPS/ldaps_load_grib.py
```

#### 처리 과정
1. **GRIB2 다운로드**: KMA Open API를 통한 원본 기상 데이터 수집
2. **지역 마스킹**: 대상 지역 (경남·경북·대구·울산·부산) 추출
3. **NetCDF 변환**: 분석 가능한 격자 데이터로 변환
4. **시계열 구성**: 24시간 연속 데이터로 재구성

#### 출력 파일
- **GRIB 원본**: `data/LDAPS/GRIB/l015_YYYYMMDDHHMM_lspr_h000.gb2`
- **NetCDF 처리본**: `data/LDAPS/NetCDF/LDAPS_Rain_YYYYMMDD.nc`

#### 환경변수 설정
```bash
# KMA API 키 설정 (필수)
set KMA_SERVICE_KEY=your_api_key_here
```

### 위성 데이터 (예정)
- **Sentinel-1 SAR**: InSAR 변위 측정
- **처리 주기**: 6/12일 간격
- **공간 해상도**: 20m

### 지형 데이터 (예정)
- **DEM**: 수치표고모델
- **경사도**: 사면 안정성 분석
- **토지이용**: 식생 및 개발 현황

